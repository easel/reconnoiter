.SUFFIXES: .lo .@MODULEEXT@

CC=@CC@
LD=@LD@
CPPFLAGS=@CPPFLAGS@
CFLAGS=@CFLAGS@
SHCFLAGS=@SHCFLAGS@
MODULELD=@MODULELD@
MODULEEXT=@MODULEEXT@
LDFLAGS=@LDFLAGS@
AR=@AR@
RANLIB=@RANLIB@
LIBS=@LIBS@
INSTALL=@INSTALL@

top_srcdir=@top_srcdir@

MODULES=ping_icmp.@MODULEEXT@ http.@MODULEEXT@ @BUILD_MODULES@

all:	$(MODULES)

http.@MODULEEXT@:	http.lo
	$(MODULELD) $(LDFLAGS) -o $@ http.lo @SERFLIBS@ ../serf/.libs/libserf-0.a -lz -lssl -lcrypto

http.lo:	http.c
	$(CC) $(CPPFLAGS) $(SHCFLAGS) -I$(top_srcdir)/src/serf @SERFCFLAGS@ -c http.c -o $@

snmp.@MODULEEXT@:	snmp.lo
	$(MODULELD) $(LDFLAGS) -o $@ snmp.lo -lnetsnmp

.lo.@MODULEEXT@:
	$(MODULELD) $(LDFLAGS) -o $@ $<

.c.lo:
	$(CC) $(CPPFLAGS) $(SHCFLAGS) -c $< -o $@

clean:
	rm -f *.lo *.@MODULEEXT@
