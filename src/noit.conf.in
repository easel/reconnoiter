<?xml version="1.0" encoding="utf8" standalone="yes"?>
<noit>
  <eventer>
    <config>
      <default_queue_threads>10</default_queue_threads>
      <default_ca_chain>%sysconfdir%/default-ca-chain.crt</default_ca_chain>
    </config>
  </eventer>
  <logs>
    <console_output>
      <outlet name="stderr"/>
      <log name="error"/>
      <log name="debug" disabled="true"/>
    </console_output>
    <feeds>
      <log name="feed" type="jlog" path="/var/log/noitd.feed(stratcon)"/>
    </feeds>
    <components>
      <error>
        <outlet name="error"/>
        <log name="error/collectd"/>
        <log name="error/dns"/>
        <log name="error/eventer"/>
        <log name="error/external"/>
        <log name="error/lua"/>
        <log name="error/mysql"/>
        <log name="error/ping_icmp"/>
        <log name="error/postgres"/>
        <log name="error/selfcheck"/>
        <log name="error/snmp"/>
        <log name="error/ssh2"/>
      </error>
      <debug>
        <outlet name="debug"/>
        <log name="debug/collectd" disabled="true"/>
        <log name="debug/dns" disabled="true"/>
        <log name="debug/eventer" disabled="true"/>
        <log name="debug/external" disabled="true"/>
        <log name="debug/lua" disabled="true"/>
        <log name="debug/mysql" disabled="true"/>
        <log name="debug/ping_icmp" disabled="true"/>
        <log name="debug/postgres" disabled="true"/>
        <log name="debug/selfcheck" disabled="true"/>
        <log name="debug/snmp" disabled="true"/>
        <log name="debug/ssh2" disabled="true"/>
      </debug>
    </components>
    <feeds>
      <outlet name="feed"/>
      <log name="check">
        <outlet name="error"/>
      </log>
      <log name="status"/>
      <log name="metrics"/>
      <log name="config"/>
    </feeds>
  </logs>
  <modules directory="%modulesdir%">
    <loader image="lua" name="lua">
      <config><directory>%modulesluadir%/?.lua</directory></config>
    </loader>
    <module image="selfcheck" name="selfcheck"/>
    <module image="ping_icmp" name="ping_icmp"/>
    <module image="snmp" name="snmp"/>
    <module image="ssh2" name="ssh2"/>
    <module loader="lua" name="varnish" object="noit.module.varnish"/>
    <module loader="lua" name="http" object="noit.module.http"/>
    <module loader="lua" name="resmon" object="noit.module.resmon"/>
    <module loader="lua" name="smtp" object="noit.module.smtp"/>
  </modules>
  <listeners>
    <sslconfig>
      <optional_no_ca>false</optional_no_ca>
      <certificate_file>%sysconfdir%/%PKIPREFIX%noit.crt</certificate_file>
      <key_file>%sysconfdir%/%PKIPREFIX%noit.key</key_file>
      <ca_chain>%sysconfdir%/%PKIPREFIX%ca.crt</ca_chain>
    </sslconfig>
    <consoles type="noit_console">
      <listener address="/tmp/noit">
        <config>
          <line_protocol>telnet</line_protocol>
        </config>
      </listener>
      <listener address="*" port="32322">
        <config>
          <line_protocol>telnet</line_protocol>
        </config>
      </listener>
      <listener address="*" port="32323" ssl="on"/>
    </consoles>
    <listener type="control_dispatch" address="*" port="43191" ssl="on">
      <config>
        <log_transit_feed_name>feed</log_transit_feed_name>
      </config>
    </listener>
  </listeners>
  <checks max_initial_stutter="30000" filterset="default">
    <check uuid="f7cea020-f19d-11dd-85a6-cb6d3a2207dc" module="selfcheck" target="10.80.117.90" period="5000" timeout="4000"/>
    <check uuid="1b4e28ba-2fa1-11d2-883f-b9b761bde3fb" module="ping_icmp" target="10.80.116.4" period="15000" timeout="14000"/>
    <dc1 timeout="30000" period="60000">
      <icmp module="ping_icmp">
        <check uuid="1b4e28ba-2fa1-11d2-883f-b9a761bde3fb" target="66.225.209.7"/>
      </icmp>
      <web module="http">
        <check uuid="1b4e28ba-2fa1-11d2-883f-b9a761bde3fc" target="66.225.209.31">
          <config>
            <url>http://ngm.nationalgeographic.com/ngm/ngm.html</url>
            <code>302</code>
          </config>
        </check>
        <check uuid="1b4e28ba-2fa1-11d2-883f-b9a761bde3aa" target="8.8.38.5">
          <config>
            <url>https://labs.omniti.com/</url>
            <code>200</code>
          </config>
        </check>
        <check uuid="1b4e28ba-2fa1-11d2-883f-b9a761bde3ff" target="8.8.38.59">
          <config>
            <url>https://taskman.omniti.com/</url>
            <code>200</code>
          </config>
        </check>
      </web>
      <resmon module="resmon" period="30000">
        <check uuid="1b4e28ba-2fa1-11d2-883f-b9a761bde3fd" timeout="2000" target="10.225.209.36"/>
      </resmon>
      <switches module="snmp" period="60000">
        <config inherit="SwitchPortX"/>
        <switch target="10.1.2.3">
          <check uuid="1b4e28ba-2fa1-11d2-883f-e9b761bde3fb" name="switchport::1"/>
          <check uuid="1b4e28ba-3fa1-11d2-883f-e9b761bde3fb" name="switchport::2"/>
          <check uuid="1b4e29ba-3fa1-11d2-883f-e9b761bde3fb" name="switchport::3"/>
          <check uuid="4deb0724-ccee-4360-83bc-255e7b9d989d" name="switchport::4"/>
        </switch>
      </switches>
      <disk module="snmp" period="60000">
        <config inherit="disk"><community>test</community></config>
        <check target="127.0.0.1" uuid="16eb9194-cbf4-11de-8fba-031dd96e4057" name="disk::1" />
      </disk>
    </dc1>
    <check uuid="002d58ff-20ff-4db0-9420-782fc1748dc4" module="ssh2" target="10.80.117.2" period="60000" timeout="4000"/>
  </checks>
  <filtersets>
    <filterset name="default">
      <rule type="deny" module="^ping_icmp$" metric="^(?:minimum|maximum|count)$" />
    </filterset>
  </filtersets>
  <config_templates>
    <config id="SwitchPort">
      <oid_description>IF-MIB::ifDescr.%[:ccns:name]</oid_description>
      <oid_alias>IF-MIB::ifAlias.%[:ccns:name]</oid_alias>
      <oid_speed>IF-MIB::ifSpeed.%[:ccns:name]</oid_speed>
      <oid_adminstatus>IF-MIB::ifAdminStatus.%[:ccns:name]</oid_adminstatus>
      <oid_operstatus>IF-MIB::ifOperStatus.%[:ccns:name]</oid_operstatus>
      <oid_inoctets>IF-MIB::ifInOctets.%[:ccns:name]</oid_inoctets>
      <oid_outoctets>IF-MIB::ifOutOctets.%[:ccns:name]</oid_outoctets>
      <oid_inerrors>IF-MIB::ifInErrors.%[:ccns:name]</oid_inerrors>
      <oid_outerrors>IF-MIB::ifOutErrors.%[:ccns:name]</oid_outerrors>
      <oid_indiscards>IF-MIB::ifInDiscards.%[:ccns:name]</oid_indiscards>
      <oid_outdiscards>IF-MIB::ifOutDiscards.%[:ccns:name]</oid_outdiscards>
      <oid_inucastpkts>IF-MIB::ifInUcastPkts.%[:ccns:name]</oid_inucastpkts>
      <oid_outucastpkts>IF-MIB::ifOutUcastPkts.%[:ccns:name]</oid_outucastpkts>
      <oid_inbcastpkts>IF-MIB::ifInNUcastPkts.%[:ccns:name]</oid_inbcastpkts>
      <oid_outbcastpkts>IF-MIB::ifOutNUcastPkts.%[:ccns:name]</oid_outbcastpkts>
    </config>
    <config id="SwitchPortX">
      <oid_description>IF-MIB::ifName.%[:ccns:name]</oid_description>
      <oid_alias>IF-MIB::ifAlias.%[:ccns:name]</oid_alias>
      <oid_speed>IF-MIB::ifSpeed.%[:ccns:name]</oid_speed>
      <oid_adminstatus>IF-MIB::ifAdminStatus.%[:ccns:name]</oid_adminstatus>
      <oid_operstatus>IF-MIB::ifOperStatus.%[:ccns:name]</oid_operstatus>
      <oid_inoctets>IF-MIB::ifHCInOctets.%[:ccns:name]</oid_inoctets>
      <oid_outoctets>IF-MIB::ifHCOutOctets.%[:ccns:name]</oid_outoctets>
      <oid_inerrors>IF-MIB::ifInErrors.%[:ccns:name]</oid_inerrors>
      <oid_outerrors>IF-MIB::ifOutErrors.%[:ccns:name]</oid_outerrors>
      <oid_indiscards>IF-MIB::ifInDiscards.%[:ccns:name]</oid_indiscards>
      <oid_outdiscards>IF-MIB::ifOutDiscards.%[:ccns:name]</oid_outdiscards>
      <oid_inucastpkts>IF-MIB::ifHCInUcastPkts.%[:ccns:name]</oid_inucastpkts>
      <oid_outucastpkts>IF-MIB::ifHCOutUcastPkts.%[:ccns:name]</oid_outucastpkts>
      <oid_inbcastpkts>IF-MIB::ifHCInBroadcastPkts.%[:ccns:name]</oid_inbcastpkts>
      <oid_outbcastpkts>IF-MIB::ifHCOutBroadcastPkts.%[:ccns:name]</oid_outbcastpkts>
    </config>
    <config id="disk">
      <oid_path>UCD-SNMP-MIB::dskPath.%[:ccns:name]</oid_path>
      <oid_device>UCD-SNMP-MIB::dskDevice.%[:ccns:name]</oid_device>
      <oid_total>UCD-SNMP-MIB::dskTotal.%[:ccns:name]</oid_total>
      <oid_avail>UCD-SNMP-MIB::dskAvail.%[:ccns:name]</oid_avail>
      <oid_used>UCD-SNMP-MIB::dskUsed.%[:ccns:name]</oid_used>
      <oid_pctspace>UCD-SNMP-MIB::dskPercent.%[:ccns:name]</oid_pctspace>
      <oid_pctinodes>UCD-SNMP-MIB::dskPercentNode.%[:ccns:name]</oid_pctinodes>
      <oid_errorflag>UCD-SNMP-MIB::dskErrorFlag.%[:ccns:name]</oid_errorflag>
      <oid_errormsg>UCD-SNMP-MIB::dskErrorMsg.%[:ccns:name]</oid_errormsg>
    </config>
  </config_templates>
</noit>
